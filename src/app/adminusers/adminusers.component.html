<div>
  <div class="d-flex gap-3 py-1 text-center border-bottom align-items-center">
    <h4 style="flex-basis: 50%;">Usuarios</h4>
    <div style="flex-basis: 50%;" class="row justify-items-evenly align-items-center gap-3 px-3">
      <button class="btn btn-success col d-flex gap-2 justify-content-center align-items-center" (click)="changeOption(0)"><i class="fas fa-plus"></i> Crear Usuarios</button>
      <button class="btn btn-dark col d-flex gap-2 justify-content-center align-items-center" (click)="changeOption(1)"><i class="fas fa-eye"></i> Ver Usuarios</button>
    </div>
  </div>
  <div class="card p-2" style="overflow-y: auto; max-height: 80vh;">
    <table id="table-user" class="table card-body">
      <thead>
        <tr>
          <th>ID</th>
          <th>Rol</th>
          <th>Nombre</th>
          <th>Apellido</th>
          <th>Email</th>
          <th>Tipo Doc.</th>
          <th>Identificación</th>
          <th>Modificar</th>
          <th>Eliminar</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let usuario of usuarios" class="align-items-center">
          <td>{{ usuario.id_usuario }}</td>
          <td>{{ usuario.rol }}</td>
          <td>{{ usuario.nombres }}</td>
          <td>{{ usuario.apellidos }}</td>
          <td>{{ usuario.email }}</td>
          <td>{{ usuario.tipo_documento }}</td>
          <td>{{ usuario.identificacion }}</td>
          <td><button (click)="modifyUser(usuario.email)" class="btn"><i class="fas fa-pen"></i></button></td>
          <td><button (click)="confirmDelete(usuario.email)" class="btn"><i class="fas fa-trash"></i></button></td>
        </tr>
      </tbody>
    </table>

    <div id="create-user">
      <form action="" class="form">
        <div class="column-form" id="div-identification">
          <div class="input-form">
            <label for="">Nombres</label>
            <label class="warn warn_name" for="">El nombre no puede estar vacío</label>
            <input class="form-control" [(ngModel)]="name" type="text" name="name" placeholder="Ingrese su Nombre">
          </div>

          <div class="input-form">
            <label for="">Apellidos</label>
            <label class="warn warn_surname" for="">El apellido no puede estar vacío</label>
            <input class="form-control" [(ngModel)]="surname" type="text" name="surname" placeholder="Ingrese sus Apellidos">
          </div>

          <div class="input-form">
            <label for="">Celular</label>
            <label class="warn warn_phone" for="">El celular no puede estar vacío</label>
            <input class="form-control" [(ngModel)]="number" name="cellphone" placeholder="Ingrese su Número" type="number" min="0" oninput="this.value = !!this.value && Math.abs(this.value) >= 0 ? Math.abs(this.value) : null">
          </div>
        </div>
        <div class="column-form" id="div-credential">
          <div class="input-form">
            <label for="">Email</label>
            <label class="warn warn_email" for="">El correo ingresado no es válido</label>
            <input class="form-control" [(ngModel)]="email" type="text" name="email" placeholder="Ingrese su Email">
          </div>

          <div class="input-form show-or-hide">
            <label for="">Contraseña</label>
            <label class="warn warn_pass" for="">Debe tener mínimo 8 carácteres</label>
            <input class="form-control" [(ngModel)]="password" type="password" name="password" placeholder="Ingrese su Contraseña">
          </div>

          <div class="input-form show-or-hide">
            <label for="">Confirmar contraseña</label>
            <label class="warn warn_con_pass" for="">No coinciden</label>
            <input class="form-control" [(ngModel)]="confirm_pass" type="password" name="con-password" placeholder="Confirme su contraseña">
          </div>
        </div>
        <div class="column-form" id="div-personalinfo">
          <div class="input-form">
            <label for="">Género</label>
            <select class="form-select" #genders (change)="changeGender(genders.value)">
              <option selected>Masculino</option>
              <option>Femenino</option>
              <option>Prefiero no decirlo</option>
            </select>
          </div>

          <div class="input-form show-or-hide">
            <label for="">Tipo de documento</label>
            <select class="form-select" #doctypes (change)="changeDocType(doctypes.value)">
              <option selected>Cédula de Ciudadanía</option>
              <option>Tarjeta de Identidad</option>
            </select>
          </div>

          <div class="input-form show-or-hide">
            <label for="">Documento</label>
            <label class="warn warn_doc" for="">El documento no puede estar vacío</label>
            <input class="form-control" [(ngModel)]="document" name="document" placeholder="Ingrese su Número de Documento" type="number" min="0" oninput="this.value = !!this.value && Math.abs(this.value) >= 0 ? Math.abs(this.value) : null">
          </div>
        </div>
        <div class="column-form column-date" id="div-date">
          <div class="input-form show-or-hide">
            <label for="">Fecha de nacimiento</label>
            <label class="warn warn_birth" for="">Seleccione una fecha de nacimiento</label>
            <label class="warn warn_birth_more" for="">Debe tener mas de 16 años</label>
            <input class="form-control" [(ngModel)]="birthdate" type="date" name="birthdate">
          </div>
          <div class="input-form show-or-hide">
            <label for="">Rol</label>
            <select class="form-select" #rol (change)="changeRol(rol.value)">
              <option selected>Cliente</option>
              <option>Administrador</option>
            </select>
          </div>
          <div class="input-form div-btn">
            <button class="btn btn-primary btn-create-user" (click)="registerUser()">Crear</button>
          </div>
        </div>
      </form>
    </div>


    <div id="modify-user">
      <form action="" class="form">
        <div class="column-form-modify" id="div-identification">
          <div class="input-form">
            <label for="">Nombres</label>
            <label class="warn warn_name" for="">El nombre no puede estar vacío</label>
            <input class="form-control" [(ngModel)]="name" type="text" name="name" placeholder="Ingrese su Nombre">
          </div>

          <div class="input-form">
            <label for="">Apellidos</label>
            <label class="warn warn_surname" for="">El apellido no puede estar vacío</label>
            <input class="form-control" [(ngModel)]="surname" type="text" name="surname" placeholder="Ingrese sus Apellidos">
          </div>
        </div>
        <div class="column-form-modify" id="div-credential">
          <div class="input-form">
            <label for="">Celular</label>
            <label class="warn warn_phone" for="">El celular no puede estar vacío</label>
            <input class="form-control" [(ngModel)]="number" name="cellphone" placeholder="Ingrese su Número" type="number" min="0" oninput="this.value = !!this.value && Math.abs(this.value) >= 0 ? Math.abs(this.value) : null">
          </div>
          <div class="input-form">
            <label for="">Género</label>
            <select class="form-select" #genders (change)="changeGender(genders.value)">
              <option selected>Masculino</option>
              <option>Femenino</option>
              <option>Prefiero no decirlo</option>
            </select>
          </div>
        </div>
        <div class="input-form div-btn-modify d-flex justify-content-center">
          <button class="btn btn-primary btn-modify-user" (click)="saveChanges()">Guardar</button>
        </div>
      </form>
    </div>
  </div>
</div>

<div class="container mt-3">
  <div class="modal fade" id=infoModal>
    <div class="modal-dialog modal-dialog-centered">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title">Modificación Exitosa</h5>
          <button class="btn btn-close" data-bs-dismiss="modal"></button>
        </div>
        <div class="modal-body" id="modal-body">
        </div>
      </div>
    </div>
  </div>
</div>

<div class="container mt-3">
  <div class="modal fade" id=deleteModal>
    <div class="modal-dialog modal-dialog-centered">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title">Eliminación de usuario</h5>
          <button class="btn btn-close" data-bs-dismiss="modal"></button>
        </div>
        <div class="modal-body" id="modal-body">
          ¿ Está seguro que desea eliminar al usuario {{emailToDelete}} ?
        </div>
        <div class="modal-footer">
          <button class="btn btn-danger" (click)="deleteUser()">Eliminar</button>
        </div>
      </div>
    </div>
  </div>
</div>
